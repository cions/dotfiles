### Key bindings

# Use Super (Windows key) as the modifier key
set $mod Mod4

# Start a terminal
bindsym $mod+Return exec foot
bindsym $mod+Shift+Return exec foot --app-id=tmux tmux new-session -A -s default

# Start a launcher
bindsym $mod+d exec bemenu-run --no-exec --single-instance | xargs -r swaymsg -- exec

# Reload the configuration file
bindsym $mod+Shift+c reload

# Kill the focused window
bindsym $mod+Shift+q kill

# Exit sway
bindsym $mod+Shift+e exec swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit sway? This will end your Wayland session.' -B 'Yes, exit sway' 'swaymsg exit'

# Move focus to the next container
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# Move focus to the parent container
bindsym $mod+a focus parent
# Move focus to the last-focused child of the focused container
bindsym $mod+z focus child

# Move the focused container
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# Switch to the specified workspace
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10

# Move the focused container to workspace
bindsym $mod+Shift+1 move container to workspace number 1, workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2, workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3, workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4, workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5, workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6, workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7, workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8, workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9, workspace number 9
bindsym $mod+Shift+0 move container to workspace number 10, workspace number 10

# Split horizontally
bindsym $mod+b split horizontal

# Split vertically
bindsym $mod+v split vertical

# Undo split
bindsym $mod+n split none

# Switch the current container between different layout styles
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# Toggle the current focus fullscreen
bindsym $mod+f fullscreen toggle

# Move focus between the floating and tiled layers
bindsym $mod+space focus mode_toggle

# Toggle the current focus between tiling and floating mode
bindsym $mod+Shift+space floating toggle

# Show the next scratchpad window or hide the focused scratchpad window.
# If there are multiple scratchpad windows, this command cycles through them.
bindsym $mod+minus scratchpad show

# Move the focused container to the scratchpad
bindsym $mod+Shift+minus move container to scratchpad

# When $mod key is held down, left click to move windows and right click to resize them
floating_modifier $mod normal

# Resize mode
bindsym $mod+r mode "resize"

mode "resize" {
    bindsym h resize shrink width 10px
    bindsym j resize grow height 10px
    bindsym k resize shrink height 10px
    bindsym l resize grow width 10px
    bindsym Left resize shrink width 10px
    bindsym Down resize grow height 10px
    bindsym Up resize shrink height 10px
    bindsym Right resize grow width 10px

    bindsym Return mode "default"
    bindsym Escape mode "default"
}

# Lock sway session
bindsym $mod+Ctrl+l exec swaylock --ignore-empty-password --show-failed-attempts --color 1e1e1e

# Adjust volume
bindsym --locked XF86AudioMute exec pactl set-sink-mute "@DEFAULT_SINK@" toggle
bindsym --locked XF86AudioLowerVolume exec pactl set-sink-volume "@DEFAULT_SINK@" -5%
bindsym --locked XF86AudioRaiseVolume exec pactl set-sink-volume "@DEFAULT_SINK@" +5%

# Take a screenshot
set $ssfile $(xdg-user-dir PICTURES)/screenshot_$(date +"%Y%m%d%H%M%S").png
bindsym Print exec grim $ssfile
bindsym Control+Print exec grim -g "$(slurp)" $ssfile

### Appearance

# Set the system default XCursor theme
seat seat0 xcursor_theme Adwaita 18

# Set title bar font
font pango:monospace 10

# Set default border style for new tiled windows
default_border normal 2

# Set default border style for new floating windows
default_floating_border normal 2

# Initial layout for new containers in an empty workspace
workspace_layout tabbed

# Set spacing around each window
gaps inner 0

# Set spacing around each workspace
gaps outer 0

# no borders if only one visible window
smart_borders on

# no gaps if only one visible window
smart_gaps on

### for_window actions

# Show app_id in window title
for_window [app_id="."] title_format "[%app_id] %title"

# Show class / instance in window title
for_window [shell="xwayland"] title_format "[X11 (%class / %instance)] %title"

for_window [window_role="bubble"] floating enable
for_window [window_role="dialog"] floating enable
for_window [window_role="pop-up"] floating enable
for_window [window_role="task_dialog"] floating enable
for_window [window_type="dialog"] floating enable
for_window [window_type="menu"] floating enable

for_window [app_id="org.keepassxc.KeePassXC"] floating enable
for_window [title="^Save File$"] floating enable
for_window [title="^Developer Tools - "] floating enable, \
    resize set width 1300px height 570px, move position 100ppt 100ppt, move left 1300px, move up 570px
for_window [title="^Developer Tools - "] floating enable, \
    resize set width 1300px height 570px, move position 100ppt 100ppt, move left 1300px, move up 570px
for_window [title="^Picture in picture$"] floating enable, sticky enable, \
    resize set width 600px height 400px, move position 100ppt 100ppt, move left 600px, move up 400px

assign [app_id="tmux"] workspace number 1
assign [app_id="vivaldi"] workspace number 2
assign [instance="sxiv"] workspace number 3
assign [app_id="firefox"] workspace number 4

### Autostart

exec swayidle -w \
    timeout 600 'pgrep -x swaylock || swaylock --ignore-empty-password --show-failed-attempts --color 1e1e1e' \
    timeout 900 'swaymsg "output * power off"' \
    resume 'swaymsg "output * power on"'

exec mako
exec fcitx5 --replace

exec foot --app-id=tmux tmux new-session -A -s default
exec vivaldi

### Input / Output configuration

input type:keyboard {
    xkb_model "jp106"
    xkb_layout "jp"
    xkb_options "japan:muhenkan_escape"
}

input type:touchpad {
    dwt enabled
    tap enabled
    drag enabled
    drag_lock disabled
    scroll_method edge
    natural_scroll disabled
    middle_emulation enabled
}

### Status Bar
bar {
        status_command waybar
        mode invisible
}
