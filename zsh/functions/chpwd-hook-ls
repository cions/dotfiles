#autoload

if (( ZSH_SUBSHELL )) return 0

local files max
local -x QUOTING_STYLE=literal

zstyle -s ':chpwd:ls' max-files max || max=50
files=( *(DN) )
if (( ${#files} > max )) {
    command ls -dACF --color -- "${(@)files[1,max]}"
    print "${#files} files exist"
} else {
    command ls -ACF --color
}
return 0
