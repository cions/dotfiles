# vim: set ft=zsh:

emulate -L zsh
setopt extended_glob

local selected

if (( ! ${+commands[fzy]} )) return
if [[ ${PWD} == "/" ]] return

echoti cud1
selected="$(print -rl -- (../)#(od:A) | fzy)"
echoti cuu1
zle reset-prompt

if [[ -n ${selected} ]] {
    if [[ -n ${BUFFER} ]] zle push-line
    BUFFER="cd ${(q)selected}"
    CURSOR=${#BUFFER}
    zle accept-line
}
